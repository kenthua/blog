---
author: Kent Hua
blogger_id: tag:blogger.com,1999:blog-3324719914062696225.post-6451008860341753067
blogger_orig_url: http://blog.kenthua.com/2015/09/jboss-operations-network-jon-33-quick.html
comments: true
date: "2015-09-01T16:38:00Z"
modified_time: "2015-09-01T16:38:20.363-07:00"
tags: null
title: JBoss Operations Network (JON) 3.3 - Quick EAP Monitoring
---

This provides some quick thoughts regarding monitoring EAP within JON, use case scenarios and how to set up the scenario.<br /><br /><br /><b>Nodes (host controllers)</b><br /><br />&nbsp; &nbsp; &nbsp;Add an admin user for JON to login<br /><pre><code class="bash"><br />./add-user.sh<br /></code></pre><br />&nbsp; &nbsp; &nbsp;Add an http interface for JON to interact with the node (https://access.redhat.com/solutions/147513)<br /><pre><code class="xml"><br />&nbsp; &nbsp; &nbsp;&lt;management-interfaces&gt;<br />&nbsp; &nbsp; &lt;native-interface security-realm="ManagementRealm"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;socket interface="management" port="${jboss.management.native.port:9999}"/&gt;<br />&nbsp; &nbsp; &lt;/native-interface&gt;<br />&nbsp; &nbsp; &lt;http-interface security-realm="ManagementRealm"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;socket interface="management" port="${jboss.management.http.port:9990}"/&gt;<br />&nbsp; &nbsp; &lt;/http-interface&gt;<br />&nbsp; &nbsp; &nbsp;&lt;/management-interfaces&gt;<br /></code></pre><br /><br /><b>Setup server up/down alerts</b><br /><br />EAP Host Controller -&gt; Managed servers -&gt; EAP h1-server1<br />Alerts<br />Definitions -&gt; New<br />&nbsp; &nbsp; &nbsp;name: server up<br />&nbsp; &nbsp; &nbsp;priority: medium<br />Conditions -&gt; Add<br />&nbsp; &nbsp; &nbsp;Condition Type: Availability Change<br />&nbsp; &nbsp; &nbsp;Availability: Goes Up<br />Recovery<br />&nbsp; &nbsp; &nbsp;Disable When Fired: Yes<br />Back to List (Definitions) -&gt; New<br />&nbsp; &nbsp; &nbsp;name: server down<br />&nbsp; &nbsp; &nbsp;priority: high<br />Conditions -&gt; Add<br />&nbsp; &nbsp; &nbsp;Condition Type: Availability Change<br />&nbsp; &nbsp; &nbsp;Availability: Goes Down<br />Recovery<br />&nbsp; &nbsp; &nbsp;Recover Alert: server up<br /><br />Check for alerts: Alerts -&gt; History<br />&nbsp; &nbsp; &nbsp;example Test<br />&nbsp; &nbsp; &nbsp;EAP Management -&gt; Domain -&gt; Overview<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h1-server1 -&gt; Stop Server<br />&nbsp; &nbsp; &nbsp;Check for Alert<br />&nbsp; &nbsp; &nbsp;EAP Management -&gt; Domain -&gt; Overview<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h1-server1 -&gt; Start Server<br />&nbsp; &nbsp; &nbsp;Check for Alert<br /><br /><b>Checking Web Server http/ajp traffic</b><br /><b><br /></b>EAP Host Controller -&gt; Managed servers -&gt; EAP h1-server1 -&gt; Subsystems -&gt; Web -&gt; web -&gt; Connector<br /><br />Monitoring, check http and ajp traffic<br /><br /><b>Compatible Groups</b><br /><b><br /></b>Inventory -&gt; Compatible Groups -&gt; New<br />&nbsp; &nbsp; &nbsp;Name: domain eap servers<br />Next<br />&nbsp; &nbsp; &nbsp;Select EAP Host/Domain Controller<br /><br /><br /><b>Working with Compatible Groups</b><br /><br />Inventory -&gt; Compatible Groups -&gt; eap servers<br />Operations -&gt; New<br />&nbsp; &nbsp; &nbsp;Restart this host controller<br />&nbsp; &nbsp; &nbsp;Now<br />&nbsp; &nbsp; &nbsp;in the order below (ripple)<br />Schedule<br />&nbsp; &nbsp; &nbsp;History<br />&nbsp; &nbsp; &nbsp;Restart this host controller<br /><br /><br /><b>Drift detection</b><br /><br />Note:<br />- Rolling drift, up to 4 snapshots of changes for comparison<br />- Pinned, based on initial snapshot 0, any changes from that point will be considered out of compliance, return to original in order to return to compliance<br />&nbsp; &nbsp; &nbsp;- What if I do not want initial snapshot 0, create a new drift config based on new current config<br /><br />New -&gt; Template-Configuration Files<br />&nbsp; &nbsp; &nbsp;Drift Definition Name: config drift<br />&nbsp; &nbsp; &nbsp;Pinned: Yes (declare current config as master)<br />&nbsp; &nbsp; &nbsp;Interval: 60 (default agent is 60, so canâ€™t go any lower unless agent is changed as well)<br />Save<br /><br />Verify JON config drift in compliance<br />Make changes to config accordingly, for instance:<br />EAP Management -&gt; Configuration -&gt; full-ha -&gt; Connector -&gt; JCA -&gt; Archive Validation<br />&nbsp; &nbsp; &nbsp;Is Enabled: false<br />Verify JON config drift out of compliance<br />EAP Management -&gt; Configuration -&gt; full-ha -&gt; Connector -&gt; JCA -&gt; Archive Validation<br />&nbsp; &nbsp; &nbsp;Is Enabled: true<br />Verify JON config drift in compliance<br /><br /><br /><b>Patching EAP</b><br /><br />Bundles -&gt; Create Bundle<br />&nbsp; &nbsp; &nbsp;Upload: jboss-eap-6.4.3-patch.zip<br />Next<br />&nbsp; &nbsp; &nbsp;Leave bundle unassigned (or assign to bundle group if one is available)